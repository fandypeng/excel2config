{"remainingRequest":"/Users/Fandy/go/src/excel2config/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Fandy/go/src/excel2config/front/src/components/CodeDiff/CodeDiffViewer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Fandy/go/src/excel2config/front/src/components/CodeDiff/CodeDiffViewer.vue","mtime":1619491542472},{"path":"/Users/Fandy/go/src/excel2config/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Fandy/go/src/excel2config/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/Fandy/go/src/excel2config/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Fandy/go/src/excel2config/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7ZGlmZkxpbmVzfSBmcm9tICdkaWZmL2xpYi9kaWZmL2xpbmUnOwppbXBvcnQgQ29kZUNodW5rIGZyb20gJy4vQ29kZURpZmZDaHVuay52dWUnOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ2NvZGUtaWZmLXZpZXdlcicsCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgQ29kZUNodW5rCiAgICB9LAogICAgcHJvcHM6IHsKICAgICAgICBvbGRDb250ZW50OiBTdHJpbmcsCiAgICAgICAgbmV3Q29udGVudDogU3RyaW5nLAogICAgICAgIHRpdGxlOiBTdHJpbmcsCiAgICAgICAgY29sbGFwc2U6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICBkZWZhdWx0OiAxMCAvLyDov57nu63otoXov4cxMOihjOayoeaUueWKqO+8jOm7mOiupOaKmOWPoAogICAgICAgIH0KICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVuaWZpZWRSZXN1bHQ6IFtdLAogICAgICAgICAgICBzcGxpdGVkTGVmdDogW10sCiAgICAgICAgICAgIHNwbGl0ZWRSaWdodDogW10KICAgICAgICB9OwogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5jYWxjdWxhdGVEaWZmKCk7CiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICAndGl0bGUnKHYpIHsKICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVEaWZmKCk7CiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBjYWxjdWxhdGVEaWZmKCkgewogICAgICAgICAgICB0aGlzLnVuaWZpZWRSZXN1bHQgPSB0aGlzLmRpZmYoKTsKICAgICAgICAgICAgdGhpcy5zcGxpdGVkTGVmdCA9IFtdOwogICAgICAgICAgICB0aGlzLnNwbGl0ZWRSaWdodCA9IFtdOwogICAgICAgICAgICBpZiAodGhpcy51bmlmaWVkUmVzdWx0Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgY29uc3Qge2xlZnQsIHJpZ2h0fSA9IHRoaXMuc3BsaXREaWZmUmVzdWx0KHRoaXMudW5pZmllZFJlc3VsdCk7CiAgICAgICAgICAgICAgICB0aGlzLmFkYXB0U3BsaXRSZXN1bHQobGVmdCwgcmlnaHQpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkaWZmKCkgewogICAgICAgICAgICAvLyDkv67mlLkKICAgICAgICAgICAgaWYgKHRoaXMubmV3Q29udGVudCAmJiB0aGlzLm9sZENvbnRlbnQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGRpZmZzID0gZGlmZkxpbmVzKHRoaXMub2xkQ29udGVudCwgdGhpcy5uZXdDb250ZW50LCB7CiAgICAgICAgICAgICAgICAgICAgaWdub3JlV2hpdGVzcGFjZTogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgbGVuZ3RoID0gZGlmZnMubGVuZ3RoOwogICAgICAgICAgICAgICAgcmV0dXJuIGRpZmZzLm1hcCgoY2h1bmssIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IGNodW5rLmFkZGVkID8gJ2FkZCcgOiAoY2h1bmsucmVtb3ZlZCA/ICdyZW1vdmUnIDogJycpOwogICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBsYXN0IGVsZW1lbnQgb2YgYXJyYXksIGJlY2F1c2Ugc3BsaXQgd2lsbCBwcm9kdWNlIG1vcmUgb25lIGxpbmUuCiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmVzID0gY2h1bmsudmFsdWUuc3BsaXQoJ1xuJyk7CiAgICAgICAgICAgICAgICAgICAgbGluZXMgPSBpbmRleCA9PT0gbGVuZ3RoIC0gMSA/IGxpbmVzLnNsaWNlKDApIDogbGluZXMuc2xpY2UoMCwgLTEpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzLAogICAgICAgICAgICAgICAgICAgICAgICBsaW5lQ291bnQ6IGxpbmVzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgY29sbGFwc2U6ICF0eXBlICYmIGxpbmVzLmxlbmd0aCA+IHRoaXMuY29sbGFwc2UKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5uZXdDb250ZW50IHx8IHRoaXMub2xkQ29udGVudCkgewogICAgICAgICAgICAgICAgLy8g5paw5aKeIG9yIOWIoOmZpAogICAgICAgICAgICAgICAgY29uc3QgZGlmZnMgPSB0aGlzLm5ld0NvbnRlbnQgfHwgdGhpcy5vbGRDb250ZW50OwogICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBkaWZmcy5zcGxpdCgnXG4nKTsKICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSAhdGhpcy5uZXdDb250ZW50ID8gJ3JlbW92ZScgOiAoIXRoaXMub2xkQ29udGVudCA/ICdhZGQnIDogJycpOwoKICAgICAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgbGluZXMsCiAgICAgICAgICAgICAgICAgICAgbGluZUNvdW50OiBsaW5lcy5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgc3RhcnRDb3VudDogMQogICAgICAgICAgICAgICAgfV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIOeUseS6jiBkaWZm5bqT6L+U5Zue55qE57uT5p6c5pivIGNodW5rIGxpc3TpnZ7lj4zovrnlr7nmr5Tnu5PmnpzvvIzmiYDku6Xov5nph4zlgZrkuoblpITnkIYKICAgICAgICAgKiAgMS4g5paw5aKe5Z2X5pS+5YWl5Y+z5L6n77yM5aaC5p6c5LiL5LiA5Z2X5Li65Yig6Zmk5Z2X5YiZ6KeG5Li65pu05pS55Luj56CB77yM5q2k5pe25bem5L6n6ZyA6KGl5YWF56m66KGM44CCCiAgICAgICAgICogIDIuIOWIoOmZpOWdl+aUvuWFpeW3puS+p++8jOWmguaenOS4i+S4gOWdl+S4uuaWsOWinuWdl+WImeinhuS4uuabtOaUueS7o+eggSwg5q2k5pe25Y+z5L6n6KGl5YWF56m66KGM44CCCiAgICAgICAgICogIDMuIOaXoOWPmOWMluWdl++8jOS4pOi+uemDvemcgOaUvuWFpeOAggogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHtBcnJheX0gZGlmZlJlc3VsdCBkaWZm5bqT6LCD55So6L+U5Zue55qE57uT5p6cCiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSB7bGVmdCwgcmlnaHR9IOW3puWPs+WIhuemu+e7k+aenAogICAgICAgICovCiAgICAgICAgc3BsaXREaWZmUmVzdWx0KGRpZmZSZXN1bHQpIHsKICAgICAgICAgICAgY29uc3QgbGVmdCA9IHsKICAgICAgICAgICAgICAgIGNodW5rczogW10sCiAgICAgICAgICAgICAgICBsaW5lQ291bnQ6IDEKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgcmlnaHQgPSB7CiAgICAgICAgICAgICAgICBjaHVua3M6IFtdLAogICAgICAgICAgICAgICAgbGluZUNvdW50OiAxCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNvbnN0IHNldENodW5rTGluZU51bWJlciA9IChjaHVuaywgbGluZU51bWVyKSA9PiB7CiAgICAgICAgICAgICAgICBjaHVuay5zdGFydExpbmVOdW1iZXIgPSBsaW5lTnVtZXI7CiAgICAgICAgICAgICAgICByZXR1cm4gbGluZU51bWVyICsgY2h1bmsubGluZUNvdW50OwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgZGlmZlJlc3VsdC5mb3JFYWNoKChjaHVuaywgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChjaHVuay50eXBlID09PSAnYWRkJykgewogICAgICAgICAgICAgICAgICAgIHJpZ2h0LmxpbmVDb3VudCA9IHNldENodW5rTGluZU51bWJlcihjaHVuaywgcmlnaHQubGluZUNvdW50KTsKICAgICAgICAgICAgICAgICAgICByaWdodC5jaHVua3MucHVzaChjaHVuayk7CiAgICAgICAgICAgICAgICAgICAgLy8g5Yik5pat5piv5ZCm5aKe5Yqg56m655m95Z2XCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkU2V0QmxhbmsoY2h1bmsudHlwZSwgaW5kZXgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQuY2h1bmtzLnB1c2godGhpcy5jcmVhdGVCbGFua0NodW5rKGNodW5rLmxpbmVDb3VudCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNodW5rLnR5cGUgPT09ICdyZW1vdmUnKSB7CiAgICAgICAgICAgICAgICAgICAgbGVmdC5saW5lQ291bnQgPSBzZXRDaHVua0xpbmVOdW1iZXIoY2h1bmssIGxlZnQubGluZUNvdW50KTsKICAgICAgICAgICAgICAgICAgICBsZWZ0LmNodW5rcy5wdXNoKGNodW5rKTsKICAgICAgICAgICAgICAgICAgICAvLyDliKTmlq3mmK/lkKblop7liqDnqbrnmb3lnZcKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRTZXRCbGFuayhjaHVuay50eXBlLCBpbmRleCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQuY2h1bmtzLnB1c2godGhpcy5jcmVhdGVCbGFua0NodW5rKGNodW5rLmxpbmVDb3VudCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIOayoeacieWPmOWKqO+8jOS4pOi+ueaUvuWFpeOAggogICAgICAgICAgICAgICAgICAgIGxlZnQubGluZUNvdW50ID0gc2V0Q2h1bmtMaW5lTnVtYmVyKGNodW5rLCBsZWZ0LmxpbmVDb3VudCk7CiAgICAgICAgICAgICAgICAgICAgbGVmdC5jaHVua3MucHVzaChjaHVuayk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsb25lZENodW5rID0gey4uLmNodW5rfTsKICAgICAgICAgICAgICAgICAgICByaWdodC5saW5lQ291bnQgPSBzZXRDaHVua0xpbmVOdW1iZXIoY2xvbmVkQ2h1bmssIHJpZ2h0LmxpbmVDb3VudCk7CiAgICAgICAgICAgICAgICAgICAgcmlnaHQuY2h1bmtzLnB1c2goY2xvbmVkQ2h1bmspOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIHtsZWZ0LCByaWdodH07CiAgICAgICAgfSwKICAgICAgICBhZGFwdFNwbGl0UmVzdWx0KGxlZnQsIHJpZ2h0KSB7CiAgICAgICAgICAgIGxlZnQuY2h1bmtzLmZvckVhY2goKGxlZnRDaHVuaywgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJpZ2h0Q2h1bmsgPSByaWdodC5jaHVua3NbaW5kZXhdOwogICAgICAgICAgICAgICAgaWYgKGxlZnRDaHVuay5jb2xsYXBzZSAmJiByaWdodENodW5rLmNvbGxhcHNlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V5LiL5bem5Y+z5qCPY2h1bmsgaW5kZXg7IOeCueWHu+WxleW8gOaXtu+8jOmAmui/h+atpGluZGV45a6a5L2NY2h1bmvov5vooYzlsZXlvIDjgIIKICAgICAgICAgICAgICAgICAgICBsZWZ0Q2h1bmsubGVmdEluZGV4ID0gcmlnaHRDaHVuay5sZWZ0SW5kZXggPSB0aGlzLnNwbGl0ZWRMZWZ0Lmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICBsZWZ0Q2h1bmsucmlnaHRJbmRleCA9IHJpZ2h0Q2h1bmsucmlnaHRJbmRleCA9IHRoaXMuc3BsaXRlZFJpZ2h0Lmxlbmd0aDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0ZWRMZWZ0LnB1c2gobGVmdENodW5rKTsKICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRlZFJpZ2h0LnB1c2gocmlnaHRDaHVuayk7CgogICAgICAgICAgICAgICAgLy8g5L+u5pS555qE6KGM5pWw5LiN5LiA6Ie05pe277yM6KGl5YWF56m655m95Z2X44CC5L6L5aaC77ya5bem5qCP5Yig6ZmkIDPooYzvvIzlj7PmoI/mt7vliqA16KGM5Luj56CB44CC5YiZ5bem5qCP6ZyA6KGl5YWFIDLooYznqbrnmb3vvIzov5vooYzlr7npvZDjgIIKICAgICAgICAgICAgICAgIGlmIChsZWZ0Q2h1bmsudHlwZSA9PT0gJ3JlbW92ZScgJiYgcmlnaHRDaHVuay50eXBlID09PSAnYWRkJykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gbGVmdENodW5rLmxpbmVDb3VudCAtIHJpZ2h0Q2h1bmsubGluZUNvdW50OwogICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCA8IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdGVkTGVmdC5wdXNoKHRoaXMuY3JlYXRlQmxhbmtDaHVuayhNYXRoLmFicyhjb3VudCkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY291bnQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRlZFJpZ2h0LnB1c2godGhpcy5jcmVhdGVCbGFua0NodW5rKGNvdW50KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiDmmK/lkKblupTor6Xorr7nva7nqbrnmb3lnZfvvJoKICAgICAgICAgKiAgICAxLiDmnIDlkI7kuIDlnZfov5Tlm54gdHJ1ZQogICAgICAgICAqICAgIDIuIOW9k+WJjeWdl+aYr+KAmHJlbW92ZSfnsbvlnovvvIznnIvkuIvkuIDlnZfnsbvlnovmmK/lkKbkuLrnqbrvvIjmsqHmnInlj5jljJbvvIkKICAgICAgICAgKiAgICAzLiDlvZPliY3lnZfmmK/igJhhZGQn57G75Z6L77yM55yL5LiK5LiA5Z2X57G75Z6L5piv5ZCm5Li656m6KOayoeacieWPmOWMlikKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB7dHlwZX0gdHlwZSDlvZPliY3lnZfnsbvlnosKICAgICAgICAgKiBAcGFyYW0ge2luZGRleH0gaW5kZXgg5b2T5YmN5Z2X57Si5byVCiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0KICAgICAgICAgKi8KICAgICAgICBzaG91bGRTZXRCbGFuayh0eXBlLCBpbmRleCkgewogICAgICAgICAgICBpZiAoaW5kZXggPT09IHRoaXMudW5pZmllZFJlc3VsdC5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpbmRleCA9IHR5cGUgPT09ICdyZW1vdmUnID8gaW5kZXggKyAxIDogaW5kZXggLSAxOwoKICAgICAgICAgICAgY29uc3QgY2h1bmsgPSB0aGlzLnVuaWZpZWRSZXN1bHRbaW5kZXhdOwogICAgICAgICAgICByZXR1cm4gIWNodW5rIHx8ICFjaHVuay50eXBlOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIOWIm+W7uuepuueZveWdlwogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGxpbmVDb3VudCDooYzmlbAKICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IOepuueZveWdl+WvueixoQogICAgICAgICAqLwogICAgICAgIGNyZWF0ZUJsYW5rQ2h1bmsobGluZUNvdW50KSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICB0eXBlOiAnYmxhbmsnLAogICAgICAgICAgICAgICAgbGluZUNvdW50LAogICAgICAgICAgICAgICAgbGluZXM6IG5ldyBBcnJheShsaW5lQ291bnQpLmZpbGwoJyAnKQogICAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgZXhwYW5kQ2h1bmsobGVmdEluZGV4LCByaWdodEluZGV4KSB7CiAgICAgICAgICAgIHRoaXMuc3BsaXRlZExlZnRbbGVmdEluZGV4XS5jb2xsYXBzZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnNwbGl0ZWRSaWdodFtyaWdodEluZGV4XS5jb2xsYXBzZSA9IGZhbHNlOwogICAgICAgIH0KICAgIH0KfTsK"},{"version":3,"sources":["CodeDiffViewer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CodeDiffViewer.vue","sourceRoot":"src/components/CodeDiff","sourcesContent":["<template>\n    <div class=\"diff-viewer\">\n        <h3>{{title}}</h3>\n        <div class=\"container\" v-if=\"newContent && oldContent\">\n            <div class=\"left\">\n                <code-chunk v-for=\"(chunk, index) in splitedLeft\"\n                    :key=\"index\"\n                    :chunk=\"chunk\" @expand=\"expandChunk\"/>\n            </div>\n            <div class=\"right\">\n                <code-chunk v-for=\"(chunk, index) in splitedRight\"\n                    :key=\"index\"\n                    :chunk=\"chunk\" @expand=\"expandChunk\"/>\n            </div>\n        </div>\n        <div v-else v-for=\"(chunk, index) in unifiedResult\"\n            :key=\"index\">\n            <code-chunk :chunk=\"chunk\" :index=\"index\"/>\n        </div>\n    </div>\n</template>\n\n<script>\nimport {diffLines} from 'diff/lib/diff/line';\nimport CodeChunk from './CodeDiffChunk.vue';\n\nexport default {\n    name: 'code-iff-viewer',\n    components: {\n        CodeChunk\n    },\n    props: {\n        oldContent: String,\n        newContent: String,\n        title: String,\n        collapse: {\n            type: Number,\n            default: 10 // 连续超过10行没改动，默认折叠\n        }\n    },\n    data() {\n        return {\n            unifiedResult: [],\n            splitedLeft: [],\n            splitedRight: []\n        };\n    },\n    created() {\n        this.calculateDiff();\n    },\n    watch: {\n        'title'(v) {\n            this.calculateDiff();\n        }\n    },\n    methods: {\n        calculateDiff() {\n            this.unifiedResult = this.diff();\n            this.splitedLeft = [];\n            this.splitedRight = [];\n            if (this.unifiedResult.length) {\n                const {left, right} = this.splitDiffResult(this.unifiedResult);\n                this.adaptSplitResult(left, right);\n            }\n        },\n        diff() {\n            // 修改\n            if (this.newContent && this.oldContent) {\n                const diffs = diffLines(this.oldContent, this.newContent, {\n                    ignoreWhitespace: false\n                });\n                const length = diffs.length;\n                return diffs.map((chunk, index) => {\n                    const type = chunk.added ? 'add' : (chunk.removed ? 'remove' : '');\n                    // delete last element of array, because split will produce more one line.\n                    let lines = chunk.value.split('\\n');\n                    lines = index === length - 1 ? lines.slice(0) : lines.slice(0, -1);\n                    return {\n                        type,\n                        lines,\n                        lineCount: lines.length,\n                        collapse: !type && lines.length > this.collapse\n                    };\n                });\n            }\n            else if (this.newContent || this.oldContent) {\n                // 新增 or 删除\n                const diffs = this.newContent || this.oldContent;\n                const lines = diffs.split('\\n');\n                const type = !this.newContent ? 'remove' : (!this.oldContent ? 'add' : '');\n\n                return [{\n                    type,\n                    lines,\n                    lineCount: lines.length,\n                    startCount: 1\n                }];\n            }\n            return [];\n        },\n\n        /**\n         * 由于 diff库返回的结果是 chunk list非双边对比结果，所以这里做了处理\n         *  1. 新增块放入右侧，如果下一块为删除块则视为更改代码，此时左侧需补充空行。\n         *  2. 删除块放入左侧，如果下一块为新增块则视为更改代码, 此时右侧补充空行。\n         *  3. 无变化块，两边都需放入。\n         *\n         * @param {Array} diffResult diff库调用返回的结果\n         * @return {Object} {left, right} 左右分离结果\n        */\n        splitDiffResult(diffResult) {\n            const left = {\n                chunks: [],\n                lineCount: 1\n            };\n            const right = {\n                chunks: [],\n                lineCount: 1\n            };\n            const setChunkLineNumber = (chunk, lineNumer) => {\n                chunk.startLineNumber = lineNumer;\n                return lineNumer + chunk.lineCount;\n            };\n\n            diffResult.forEach((chunk, index) => {\n                if (chunk.type === 'add') {\n                    right.lineCount = setChunkLineNumber(chunk, right.lineCount);\n                    right.chunks.push(chunk);\n                    // 判断是否增加空白块\n                    if (this.shouldSetBlank(chunk.type, index)) {\n                        left.chunks.push(this.createBlankChunk(chunk.lineCount));\n                    }\n                }\n                else if (chunk.type === 'remove') {\n                    left.lineCount = setChunkLineNumber(chunk, left.lineCount);\n                    left.chunks.push(chunk);\n                    // 判断是否增加空白块\n                    if (this.shouldSetBlank(chunk.type, index)) {\n                        right.chunks.push(this.createBlankChunk(chunk.lineCount));\n                    }\n                }\n                else {\n                    // 没有变动，两边放入。\n                    left.lineCount = setChunkLineNumber(chunk, left.lineCount);\n                    left.chunks.push(chunk);\n\n                    const clonedChunk = {...chunk};\n                    right.lineCount = setChunkLineNumber(clonedChunk, right.lineCount);\n                    right.chunks.push(clonedChunk);\n                }\n            });\n            return {left, right};\n        },\n        adaptSplitResult(left, right) {\n            left.chunks.forEach((leftChunk, index) => {\n                const rightChunk = right.chunks[index];\n                if (leftChunk.collapse && rightChunk.collapse) {\n                    // 记录下左右栏chunk index; 点击展开时，通过此index定位chunk进行展开。\n                    leftChunk.leftIndex = rightChunk.leftIndex = this.splitedLeft.length;\n                    leftChunk.rightIndex = rightChunk.rightIndex = this.splitedRight.length;\n                }\n\n                this.splitedLeft.push(leftChunk);\n                this.splitedRight.push(rightChunk);\n\n                // 修改的行数不一致时，补充空白块。例如：左栏删除 3行，右栏添加5行代码。则左栏需补充 2行空白，进行对齐。\n                if (leftChunk.type === 'remove' && rightChunk.type === 'add') {\n                    const count = leftChunk.lineCount - rightChunk.lineCount;\n                    if (count < 0) {\n                        this.splitedLeft.push(this.createBlankChunk(Math.abs(count)));\n                    }\n                    else if (count > 0) {\n                        this.splitedRight.push(this.createBlankChunk(count));\n                    }\n                }\n            });\n        },\n\n        /**\n         * 是否应该设置空白块：\n         *    1. 最后一块返回 true\n         *    2. 当前块是‘remove'类型，看下一块类型是否为空（没有变化）\n         *    3. 当前块是‘add'类型，看上一块类型是否为空(没有变化)\n         *\n         * @param {type} type 当前块类型\n         * @param {inddex} index 当前块索引\n         * @return {boolean}\n         */\n        shouldSetBlank(type, index) {\n            if (index === this.unifiedResult.length - 1) {\n                return true;\n            }\n            index = type === 'remove' ? index + 1 : index - 1;\n\n            const chunk = this.unifiedResult[index];\n            return !chunk || !chunk.type;\n        },\n\n        /**\n         * 创建空白块\n         *\n         * @param {number} lineCount 行数\n         * @return {Object} 空白块对象\n         */\n        createBlankChunk(lineCount) {\n            return {\n                type: 'blank',\n                lineCount,\n                lines: new Array(lineCount).fill(' ')\n            };\n        },\n        expandChunk(leftIndex, rightIndex) {\n            this.splitedLeft[leftIndex].collapse = false;\n            this.splitedRight[rightIndex].collapse = false;\n        }\n    }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.diff-viewer {\n    font-family: Consolas, \"Liberation Mono\", Menlo, Courier, monospace, sans-serif;\n    font-size: 12px;\n    margin-bottom: 15px;\n    border-radius: 5px;\n    border: 1px solid #ddd;\n\n    h3 {\n        box-sizing: border-box;\n        margin: 0;\n        padding: 5px 10px;\n        height: 40px;\n        line-height: 30px;\n        border-radius: 5px 5px 0 0;\n        border-bottom: 1px solid #dbdbdb;\n        background-color: #f7f7f7;\n        color: #333;\n        font-weight: 600;\n    }\n\n    .container {\n        display: flex;\n        > div {\n            width: 50%;\n        }\n    }\n}\n</style>\n"]}]}