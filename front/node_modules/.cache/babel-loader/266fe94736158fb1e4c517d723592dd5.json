{"remainingRequest":"/Users/Fandy/workspace/e2c/front/node_modules/babel-loader/lib/index.js!/Users/Fandy/workspace/e2c/front/node_modules/eslint-loader/index.js??ref--13-0!/Users/Fandy/workspace/e2c/front/src/store/modules/user.js","dependencies":[{"path":"/Users/Fandy/workspace/e2c/front/src/store/modules/user.js","mtime":1615025342513},{"path":"/Users/Fandy/workspace/e2c/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Fandy/workspace/e2c/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/Fandy/workspace/e2c/front/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3RvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgcmVnIGFzIF9yZWcsIGxvZ291dCBhcyBfbG9nb3V0LCBnZXRJbmZvIGFzIF9nZXRJbmZvIH0gZnJvbSAnQC9hcGkvdXNlcic7CmltcG9ydCB7IGdldFRva2VuLCBzZXRUb2tlbiwgcmVtb3ZlVG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOwppbXBvcnQgeyByZXNldFJvdXRlciB9IGZyb20gJ0Avcm91dGVyJzsKCnZhciBnZXREZWZhdWx0U3RhdGUgPSBmdW5jdGlvbiBnZXREZWZhdWx0U3RhdGUoKSB7CiAgcmV0dXJuIHsKICAgIHRva2VuOiBnZXRUb2tlbigpLAogICAgbmFtZTogJycsCiAgICBhdmF0YXI6ICcnCiAgfTsKfTsKCnZhciBzdGF0ZSA9IGdldERlZmF1bHRTdGF0ZSgpOwp2YXIgbXV0YXRpb25zID0gewogIFJFU0VUX1NUQVRFOiBmdW5jdGlvbiBSRVNFVF9TVEFURShzdGF0ZSkgewogICAgT2JqZWN0LmFzc2lnbihzdGF0ZSwgZ2V0RGVmYXVsdFN0YXRlKCkpOwogIH0sCiAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogIH0sCiAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBuYW1lKSB7CiAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICB9LAogIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogIH0sCiAgU0VUX1VJRDogZnVuY3Rpb24gU0VUX1VJRChzdGF0ZSwgdWlkKSB7CiAgICBzdGF0ZS51aWQgPSB1aWQ7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICAvLyB1c2VyIGxvZ2luCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYsIHVzZXJJbmZvKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICB2YXIgZW1haWwgPSB1c2VySW5mby5lbWFpbCwKICAgICAgICBwYXNzd29yZCA9IHVzZXJJbmZvLnBhc3N3b3JkLAogICAgICAgIGxvZ2luVHlwZSA9IHVzZXJJbmZvLmxvZ2luVHlwZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9sb2dpbih7CiAgICAgICAgZW1haWw6IGVtYWlsLnRyaW0oKSwKICAgICAgICBwd2Q6IHBhc3N3b3JkLAogICAgICAgIGxvZ2luVHlwZTogTnVtYmVyKGxvZ2luVHlwZSkKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLnRva2VuKTsKICAgICAgICBzZXRUb2tlbihkYXRhLnRva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyIHJlZwogIHJlZzogZnVuY3Rpb24gcmVnKF9yZWYyLCB1c2VySW5mbykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgIHZhciBlbWFpbCA9IHVzZXJJbmZvLmVtYWlsLAogICAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQsCiAgICAgICAgY29uZmlybVBhc3N3b3JkID0gdXNlckluZm8uY29uZmlybVBhc3N3b3JkLAogICAgICAgIG5pY2tuYW1lID0gdXNlckluZm8ubmlja25hbWU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfcmVnKHsKICAgICAgICBlbWFpbDogZW1haWwudHJpbSgpLAogICAgICAgIHB3ZDogcGFzc3dvcmQsCiAgICAgICAgY29uZmlybVB3ZDogY29uZmlybVBhc3N3b3JkLAogICAgICAgIG5hbWU6IG5pY2tuYW1lCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgZGF0YS50b2tlbik7CiAgICAgICAgc2V0VG9rZW4oZGF0YS50b2tlbik7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gZ2V0IHVzZXIgaW5mbwogIGdldEluZm86IGZ1bmN0aW9uIGdldEluZm8oX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9nZXRJbmZvKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgaWYgKCFkYXRhKSB7CiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdWZXJpZmljYXRpb24gZmFpbGVkLCBwbGVhc2UgTG9naW4gYWdhaW4uJyk7CiAgICAgICAgfQoKICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgZGF0YS51c2VyTmFtZSk7CiAgICAgICAgY29tbWl0KCdTRVRfQVZBVEFSJywgZGF0YS5hdmF0YXIpOwogICAgICAgIGNvbW1pdCgnU0VUX1VJRCcsIGRhdGEudWlkKTsKICAgICAgICByZXNvbHZlKGRhdGEpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gdXNlciBsb2dvdXQKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChfcmVmNCkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWY0LnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAoKICAgICAgICByZXNldFJvdXRlcigpOwogICAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyByZW1vdmUgdG9rZW4KICByZXNldFRva2VuOiBmdW5jdGlvbiByZXNldFRva2VuKF9yZWY1KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjUuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKCiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"sources":["/Users/Fandy/workspace/e2c/front/src/store/modules/user.js"],"names":["login","reg","logout","getInfo","getToken","setToken","removeToken","resetRouter","getDefaultState","token","name","avatar","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","SET_UID","uid","actions","userInfo","commit","email","password","loginType","Promise","resolve","reject","trim","pwd","Number","then","response","data","catch","error","confirmPassword","nickname","confirmPwd","userName","resetToken","namespaced"],"mappings":"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","sourcesContent":["import { login, reg, logout, getInfo } from '@/api/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: ''\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  },\n  SET_UID: (state, uid) => {\n    state.uid = uid\n  }\n}\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { email, password, loginType } = userInfo\n    return new Promise((resolve, reject) => {\n      login({ email: email.trim(), pwd: password, loginType: Number(loginType) }).then(response => {\n        const { data } = response\n        commit('SET_TOKEN', data.token)\n        setToken(data.token)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n  // user reg\n  reg({ commit }, userInfo) {\n    const { email, password, confirmPassword, nickname } = userInfo\n    return new Promise((resolve, reject) => {\n      reg({ email: email.trim(), pwd: password, confirmPwd: confirmPassword, name: nickname }).then(response => {\n        const { data } = response\n        commit('SET_TOKEN', data.token)\n        setToken(data.token)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo(state.token).then(response => {\n        const { data } = response\n\n        if (!data) {\n          return reject('Verification failed, please Login again.')\n        }\n        commit('SET_NAME', data.userName)\n        commit('SET_AVATAR', data.avatar)\n        commit('SET_UID', data.uid)\n        resolve(data)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"]}]}